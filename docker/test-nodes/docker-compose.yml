# Test nodes for homelab-manager automation testing
# Usage:
#   docker compose up -d                    # Start all nodes
#   docker compose up -d --scale node=3     # Start 3 nodes (node-1, node-2, node-3)
#   docker compose down                     # Stop all nodes
#   docker compose logs -f                  # View logs

networks:
  homelab-test:
    driver: bridge
    ipam:
      config:
        - subnet: 172.28.0.0/16
          gateway: 172.28.0.1

services:
  # Primary test node with fixed IP
  node1:
    build:
      context: .
      args:
        ROOT_PASSWORD: rootpass
        USER_NAME: ansible
        USER_PASSWORD: ansible123
    container_name: homelab-node1
    hostname: node1
    networks:
      homelab-test:
        ipv4_address: 172.28.0.10
    restart: unless-stopped

  # Secondary test node with fixed IP
  node2:
    build:
      context: .
      args:
        ROOT_PASSWORD: rootpass
        USER_NAME: ansible
        USER_PASSWORD: ansible123
    container_name: homelab-node2
    hostname: node2
    networks:
      homelab-test:
        ipv4_address: 172.28.0.11
    restart: unless-stopped

  # Third test node with fixed IP
  node3:
    build:
      context: .
      args:
        ROOT_PASSWORD: rootpass
        USER_NAME: ansible
        USER_PASSWORD: ansible123
    container_name: homelab-node3
    hostname: node3
    networks:
      homelab-test:
        ipv4_address: 172.28.0.12
    restart: unless-stopped
